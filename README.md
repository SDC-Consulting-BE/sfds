# Steve's Flutter Design System

My personal design system to facilitate the creation of webapps using Flutter.

Key packages used in the design system (not covered in this readme):

- [package_info_plus](https://pub.dev/packages/package_info_plus)
- [shared_preferences](https://pub.dev/packages/shared_preferences)
- [go_router](https://pub.dev/packages/go_router)
- [riverpod](https://pub.dev/packages/riverpod)
- [intl](https://pub.dev/packages/intl)

## Table of contents

1. [Installing](#installing)
2. [Project configuration](#project-configuration)
   1. [Lints](#lints)
   2. [Fonts](#fonts)
   3. [Riverpod](#riverpod)
   4. [Color Scheme](#color-scheme)
      1. [Theme mode switching](#theme-mode-switching)
      2. [Color Scheme Extension](#color-scheme-extension)
   5. [Routing](#routing)
      1. [Navigating to different screens](#navigating-to-different-screens)
   6. [Localization](#localization)
      1. [Fetching translations](#fetching-translations)
      2. [Locale switching](#locale-switching)
   7. [The SteveApp](#the-steveapp)
      1. [Adding configuration items](#adding-configuration-items) 
3. [Services](#services)
4. [Providers](#providers)
5. [Utilities](#utilities)

## Installing

Add the following dependency in _pubspec.yaml_:

``` yaml
dependencies:
  sfds:
    git:
      url: https://github.com/SDC-Consulting-BE/sfds
      ref: main
```

## Project configuration

The Component Library code can be used as a functional implementation / reference sheet of the design system.

### Lints

Add the following dependencies to the _pubspec.yaml_:

``` yaml
dev_dependencies:
   build_runner: ^2.9.0
   flutter_lints: ^6.0.0
```

Place the following include at the top of the _analysis_options.yaml_:

``` yaml
include: package:sfds/analysis_options.yaml
```

This will enable my personalized linter rules, including custom lints for _riverpod_.
It will work as is and requires no additional code in the _analysis_options.yaml_.

### Fonts

Merge the following entries into the _pubspec.yaml_:

``` yaml
flutter:
  fonts:
    - family: base
      fonts:
        - asset: packages/sfds/assets/font/thin.ttf
          weight: 100
        - asset: packages/sfds/assets/font/thinItalic.ttf
          weight: 100
          style: italic
        - asset: packages/sfds/assets/font/light.ttf
          weight: 300
        - asset: packages/sfds/assets/font/lightItalic.ttf
          weight: 300
          style: italic
        - asset: packages/sfds/assets/font/regular.ttf
          weight: 400
        - asset: packages/sfds/assets/font/italic.ttf
          weight: 400
          style: italic
        - asset: packages/sfds/assets/font/medium.ttf
          weight: 500
        - asset: packages/sfds/assets/font/mediumItalic.ttf
          weight: 500
          style: italic
        - asset: packages/sfds/assets/font/bold.ttf
          weight: 700
        - asset: packages/sfds/assets/font/boldItalic.ttf
          weight: 700
          style: italic
        - asset: packages/sfds/assets/font/black.ttf
          weight: 900
        - asset: packages/sfds/assets/font/blackItalic.ttf
          weight: 900
          style: italic
```

### Riverpod

Add the _riverpod_ dependencies to the _pubspec.yaml_:

``` yaml
dependencies:
   flutter_riverpod: ^3.0.3
   riverpod_annotation: ^3.0.3
   
dev_dependencies:
   build_runner: ^2.9.0
   custom_lint: ^0.8.1
   riverpod_generator: ^3.0.3
   riverpod_lint: ^3.0.3
```

> [!IMPORTANT]
> Due to some versioning issues, it is advised to add a dependency override to the _pubspec.yaml_:
> ``` yaml
> dependency_overrides:
>  test_api: ^0.7.7
> ```

To only make use of the predefined _riverpod_ providers - and none of your own - the _flutter_riverpod_ alone dependency is sufficient.

### Color scheme

The design system requires both a light and a dark color scheme. These can be generated by
the [Material Theme Builder](https://material-foundation.github.io/material-theme-builder/).
They provide default color combinations, but they can also be customized by adjusting the core colors.

[Coolors' Color Palette Generator](https://coolors.co/) can help in finding the perfect color combinations.

After selecting the core colors, proceed with the Material Theme Builder and export your theme in Flutter format.
This will download a zip folder containing a _theme.dart_ file.

From that file, extract the _lightScheme()_ and _darkScheme()_ and store them in an _app_color_scheme.dart_ file in your _lib_ folder, so that it looks like:

``` dart
const lightColorScheme = ColorScheme(
  brightness: Brightness.light,
  primary: Color(0xff785a0b),
  surfaceTint: Color(0xff785a0b),
  onPrimary: Color(0xffffffff),
  primaryContainer: Color(0xffffdfa0),
  ...
);
```

Linking the color scheme with the main app is handled later in [The SteveApp](#the-steveapp).

#### Theme mode switching

To switch the current theme mode, simply use the _SteveThemeModeProvider_ and call the _flipThemeMode()_ method:

``` dart
ref.read(steveThemeModeProvider.notifier).flipThemeMode();
```

Alternatively, use one of the theme mode selection widgets provided, such as the _SteveSliverViewAppBarActionThemeSwitcher_.

#### Color scheme extension

The design system also exposes (much needed) complementary colors (adjusted for both light and dark themes):

- success
- warning
- hyperlink
- favorite

All of these come with variants: _success, onSuccess, successContainer, onSuccessContainer_.

The colors can be accessed through a theme extension. e.g.:

``` dart
Theme.of(context).extension<SteveColorSchemeExtension>()!.hyperlink.color
```

### Routing

Start with adding the _go_router_ dependency to the _pubspec.yaml_:

``` yaml
dependencies:
   go_router: ^16.2.4
```

Create an _app_routes.dart_ file in the _lib_ folder and define a _GoRouter_ in that file, e.g.:

``` dart
final router = GoRouter(
  initialLocation: "/home",
  routes: [
    GoRoute(path: "/home", redirect: (_, _) => _subRouteLibrary),
    GoRoute(
      path: _subRouteLibrary,
      builder: (_, _) => const LibraryScreen(),
      routes: [
        GoRoute(path: _subRouteSliverView, builder: (_, _) => const SliverViewLibraryScreen()),
        GoRoute(path: _subRouteButtons, builder: (_, _) => const ButtonLibraryScreen()),
        GoRoute(path: _subRouteCards, builder: (_, _) => const CardLibraryScreen()),
        GoRoute(path: _subRouteUtilityWidgets, builder: (_, _) => const UtilityWidgetsLibraryScreen()),
      ],
    ),
  ],
);
```

Visit the [GoRouter documentation](https://pub.dev/documentation/go_router/latest/) for a complete overview of all possibilities.

Linking the routing with the main app is handled later, in [The SteveApp](#the-steveapp).

#### Navigating to different screens

Navigation can be handled by making use of the _go_ extension method on the context:

``` dart
context.go(uri)
```

Traditional navigation methods such as _NavigationState.pop()_ are still usable.

### Localization

Start with adding the _generate: true_ flag to the _pubpsec.yaml_ file:

``` yaml
flutter:
   generate: true
```

Then add the _intl_ dependency in the _pubspec.yaml_ file:

``` yaml
dependencies:
   intl: ^0.20.2
```

Then add a _l10n.yaml_ file to the root of the project containing (and modify the properties where desired):

``` yaml
arb-dir: lib/l10n
template-arb-file: intl_en.arb
output-dir: lib/l10n/generated/
output-localization-file: app_localizations.dart
output-class: Localization
preferred-supported-locales: en
nullable-getter: false
```

Following this configuration, add a _l10n_ folder in your _lib_ folder. 
For every supported language add a _.arb_ (translations) file in this folder with a file name like:

``` text
intl_{countryCode}.arb
```

For example - for German translations - that file would be named _intl_de.arb_.

Translations can be placed in these files and will programatically and automatically become available while developing (code will be generated in the _lib/l10n/generated_ folder).

Information regarding the _l10n.yaml_ file, or anything related to translations, can be found in
the [officiel Flutter documentation](https://docs.flutter.dev/ui/accessibility-and-internationalization/internationalization).

#### Fetching translations

Getting translations is as easy as getting a _Localization_ object, and subsequently getting the required property from it:

``` dart
Localization.of(context).title
```

> [!IMPORTANT]
> For performance reasons, always reuse the Localization.of(context) in every individual widget.
> The same goes for other objects that require a context, such as ThemeData, NavigationState, ... .

#### Locale switching

To switch the current locale, simply use the _SteveLocaleProvider_ and call the _selectLocale(Locale locale)_ method using the desired locale. e.g.:

``` dart
ref.read(steveLocaleProvider.notifier).selectLocale(locale);
```

Alternatively, use one of the locale selection widgets provided, such as the _SteveSliverViewAppBarActionLocaleSwitcher_.

### The SteveApp

The _SteveApp_ widget is where it all comes together.
It can be setup using the _SteveAppConfigurator_, where you can pass on the previously defined properties, followed by calling the _start()_ method:

``` dart
import "package:your_package/app_color_scheme.dart";
import "package:your_package/app_routes.dart";
import "package:your_package/l10n/generated/app_localizations.dart";
import "package:sfds/config.dart";

SteveAppConfigurator(
   title: (context) => Localization.of(context).title,
   lightColorScheme: lightColorScheme,
   darkColorScheme: darkColorScheme,
   router: router,
   delegates: Localization.localizationsDelegates,
   locales: Localization.supportedLocales,
).start();
```

#### Adding configuration items

The _SteveAppConfigurator_ exposed another method - _.withAppService(SteveAppConfigItem appService)_ - that allows the addition of user defined services that need to be setup when starting the app.

This method takes a _SteveAppConfigItem_ as argument. _SteveAppConfigItem_ is an abstract class that can be extended and only has one asynchronous method to be overriden; _.configure()_:

``` dart
abstract interface class SteveAppConfigItem {
  Future<void> configure();
}
```

## Services

Preconfigured services providing basic functionalities.

The source code can be found [here](lib/src/service).

### App Info Service

Can be used to read application information from within the web app.

``` dart
SteveAppInfoService.appName
SteveAppInfoService.packageName
SteveAppInfoService.version
```

### Local Storage Service

Can be used to interact (read and write) with the local storage. Can handle all primitive types:

+ bool
+ int
+ double
+ String
+ List`<String`>

``` dart
SteveLocalStorageService.containsKey(key);
SteveLocalStorageService.doesNotContainKey(key);
SteveLocalStorageService.remove(key);
SteveLocalStorageService.read{Type}(key);
SteveLocalStorageService.write{Type}(key, value);
SteveLocalStorageService.write{Type}IfAbsent(key, value);
```

## Providers

Riverpod based providers to handle concepts that influence the application state.

The source code can be found [here](lib/src/provider).

### Locale Provider

Can be used to manage the selected locale.

``` dart
var locale = ref.watch(steveLocaleProvider); -- value
var localeNotifier = ref.read(steveLocaleProvider.notifier); -- notifier
localeNotifier.selectLocale(locale); -- updates the current locale and updates the screen
```

### Theme Mode Provider

Can be used to manage the current theme mode (light theme / dark theme).

``` dart
var themeMode = ref.watch(steveThemeModeProvider);
var themeModeNotifier = ref.read(steveThemeModeProvider.notifier); -- notifier
themeModeNotifier.flipThemeMode(); -- flips the current theme mode (light theme <-> dark theme)
```

## Utilities

Assistive utilities that can be used to improve maintainability and handle boilerplate code.

The source contains extensive documentation.

The documented source code can be found [here](lib/src/util).

+ [Collection Util](lib/src/util/collection_util.dart)
+ [Log Util](lib/src/util/log_util.dart)
+ [Navigation Util](lib/src/util/navigation_util.dart)
+ [String Util](lib/src/util/string_util.dart)
+ [Text Style Util](lib/src/util/text_style_util.dart)
